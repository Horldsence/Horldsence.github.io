---

---

<button
    id="theme-toggle"
    class="pixel-btn fixed top-4 right-4 z-50 text-xl p-2"
    title="Toggle Theme"
>
    <span class="sun hidden">‚òÄÔ∏è</span>
    <span class="moon hidden">üåô</span>
</button>

<script>
    function initTheme() {
        const themeToggleBtn = document.getElementById("theme-toggle");
        const sunIcon = themeToggleBtn?.querySelector(".sun");
        const moonIcon = themeToggleBtn?.querySelector(".moon");

        // Initial check
        if (
            localStorage.getItem("color-theme") === "dark" ||
            (!("color-theme" in localStorage) &&
                window.matchMedia("(prefers-color-scheme: dark)").matches)
        ) {
            document.documentElement.classList.add("dark");
            sunIcon?.classList.remove("hidden");
            moonIcon?.classList.add("hidden");
        } else {
            document.documentElement.classList.remove("dark");
            moonIcon?.classList.remove("hidden");
            sunIcon?.classList.add("hidden");
        }

        // Event listener
        themeToggleBtn?.addEventListener("click", function () {
            // toggle icons inside button
            sunIcon?.classList.toggle("hidden");
            moonIcon?.classList.toggle("hidden");

            // if set via local storage previously
            if (localStorage.getItem("color-theme")) {
                if (localStorage.getItem("color-theme") === "light") {
                    document.documentElement.classList.add("dark");
                    localStorage.setItem("color-theme", "dark");
                } else {
                    document.documentElement.classList.remove("dark");
                    localStorage.setItem("color-theme", "light");
                }

                // if NOT set via local storage previously
            } else {
                if (document.documentElement.classList.contains("dark")) {
                    document.documentElement.classList.remove("dark");
                    localStorage.setItem("color-theme", "light");
                } else {
                    document.documentElement.classList.add("dark");
                    localStorage.setItem("color-theme", "dark");
                }
            }
        });
    }

    // Run on initial load
    initTheme();

    // Run on view transitions navigation
    document.addEventListener("astro:after-swap", initTheme);
</script>
